#!/usr/bin/env -S ruby -rg -rscript

# Expect exactly these flags, and error otherwise
$-g.expect! %w[h help w width]

# Usage
$h || $_help and exit <<EOS
usage: #$program_name [-w WIDTH] [file ...]
  -h, --help        Show usage
  -w, --width=WIDTH Change width from default of 80
adds a `|` and visual noise after `WIDTH` columns. Width defaults to 80. If
args are given, executes it as a command, and folds its output.
EOS

$width = Integer($width || $w || 80)

while line = $<.gets(chomp: true)
  line = line.ljust($width)
  line.insert($width, "\e[7m|")
  print line, "\e[27m\n"
end
