#!/usr/bin/env -S ruby -rg

$GLOBALS.expect! %w[h help a all]
$h || $_help and (puts <<EOS; exit)
usage: #{$0} [-a,--all] [files ...]
  -h, --help  Show usage
  -a, --all   Strip all trailing newlines
Strip the last (or all trailing) newlines
EOS

$all ||= $a

if $all
  # Inefficient workaround: Read the entirety of `stdin` it at once
  print $stdin.read.tap { |x| x.sub!(/\n*\z/, '') }
else
  while l = gets
    @l.display
    @l = l
  end

  print @l&.chomp
end
